/*
 * SimpleModal 1.4.4 - jQuery Plugin
 * http://simplemodal.com/
 * Copyright (c) 2013 Eric Martin
 * Licensed under MIT and GPL
 * Date: Sun, Jan 20 2013 15:58:56 -0800
 */(function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)})(function(a){var b=[],c=a(document),d=navigator.userAgent.toLowerCase(),e=a(window),f=[],g=null,h=/msie/.test(d)&&!/opera/.test(d),i=/opera/.test(d),j,k;j=h&&/msie 6./.test(d)&&"object"!=typeof window.XMLHttpRequest,k=h&&/msie 7.0/.test(d),a.modal=function(b,c){return a.modal.impl.init(b,c)},a.modal.close=function(){a.modal.impl.close()},a.modal.focus=function(b){a.modal.impl.focus(b)},a.modal.setContainerDimensions=function(){a.modal.impl.setContainerDimensions()},a.modal.setPosition=function(){a.modal.impl.setPosition()},a.modal.update=function(b,c){a.modal.impl.update(b,c)},a.fn.modal=function(b){return a.modal.impl.init(this,b)},a.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null},a.modal.impl={d:{},init:function(b,c){if(this.d.data)return!1;g=h&&!a.support.boxModel,this.o=a.extend({},a.modal.defaults,c),this.zIndex=this.o.zIndex,this.occb=!1;if("object"==typeof b){if(b=b instanceof a?b:a(b),this.d.placeholder=!1,0<b.parent().parent().size()&&(b.before(a("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),this.d.placeholder=!0,this.display=b.css("display"),!this.o.persist))this.d.orig=b.clone(!0)}else{if("string"!=typeof b&&"number"!=typeof b)return alert("SimpleModal Error: Unsupported data type: "+typeof b),this;b=a("<div></div>").html(b)}return this.create(b),this.open(),a.isFunction(this.o.onShow)&&this.o.onShow.apply(this,[this.d]),this},create:function(c){this.getDimensions(),this.o.modal&&j&&(this.d.iframe=a('<iframe src="javascript:false;"></iframe>').css(a.extend(this.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:f[0],width:f[1],zIndex:this.o.zIndex,top:0,left:0})).appendTo(this.o.appendTo)),this.d.overlay=a("<div></div>").attr("id",this.o.overlayId).addClass("simplemodal-overlay").css(a.extend(this.o.overlayCss,{display:"none",opacity:this.o.opacity/100,height:this.o.modal?b[0]:0,width:this.o.modal?b[1]:0,position:"fixed",left:0,top:0,zIndex:this.o.zIndex+1})).appendTo(this.o.appendTo),this.d.container=a("<div></div>").attr("id",this.o.containerId).addClass("simplemodal-container").css(a.extend({position:this.o.fixed?"fixed":"absolute"},this.o.containerCss,{display:"none",zIndex:this.o.zIndex+2})).append(this.o.close&&this.o.closeHTML?a(this.o.closeHTML).addClass(this.o.closeClass):"").appendTo(this.o.appendTo),this.d.wrap=a("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(this.d.container),this.d.data=c.attr("id",c.attr("id")||this.o.dataId).addClass("simplemodal-data").css(a.extend(this.o.dataCss,{display:"none"})).appendTo("body"),this.setContainerDimensions(),this.d.data.appendTo(this.d.wrap),(j||g)&&this.fixIE()},bindEvents:function(){var d=this;a("."+d.o.closeClass).bind("click.simplemodal",function(a){a.preventDefault(),d.close()}),d.o.modal&&d.o.close&&d.o.overlayClose&&d.d.overlay.bind("click.simplemodal",function(a){a.preventDefault(),d.close()}),c.bind("keydown.simplemodal",function(a){d.o.modal&&9===a.keyCode?d.watchTab(a):d.o.close&&d.o.escClose&&27===a.keyCode&&(a.preventDefault(),d.close())}),e.bind("resize.simplemodal orientationchange.simplemodal",function(){d.getDimensions(),d.o.autoResize?d.setContainerDimensions():d.o.autoPosition&&d.setPosition(),j||g?d.fixIE():d.o.modal&&(d.d.iframe&&d.d.iframe.css({height:f[0],width:f[1]}),d.d.overlay.css({height:b[0],width:b[1]}))})},unbindEvents:function(){a("."+this.o.closeClass).unbind("click.simplemodal"),c.unbind("keydown.simplemodal"),e.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var b=this.o.position;a.each([this.d.iframe||null,this.o.modal?this.d.overlay:null,"fixed"===this.d.container.css("position")?this.d.container:null],function(a,c){if(c){var d=c[0].style;d.position="absolute";if(2>a)d.removeExpression("height"),d.removeExpression("width"),d.setExpression("height",'document.body.scrollHeight > document.body.clientHeight ? document.body.scrollHeight : document.body.clientHeight + "px"'),d.setExpression("width",'document.body.scrollWidth > document.body.clientWidth ? document.body.scrollWidth : document.body.clientWidth + "px"');else{var e,f;b&&b.constructor===Array?(e=b[0]?"number"==typeof b[0]?b[0].toString():b[0].replace(/px/,""):c.css("top").replace(/px/,""),e=-1===e.indexOf("%")?e+' + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"':parseInt(e.replace(/%/,""))+' * ((document.documentElement.clientHeight || document.body.clientHeight) / 100) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"',b[1]&&(f="number"==typeof b[1]?b[1].toString():b[1].replace(/px/,""),f=-1===f.indexOf("%")?f+' + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"':parseInt(f.replace(/%/,""))+' * ((document.documentElement.clientWidth || document.body.clientWidth) / 100) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"')):(e='(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"',f='(document.documentElement.clientWidth || document.body.clientWidth) / 2 - (this.offsetWidth / 2) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"'),d.removeExpression("top"),d.removeExpression("left"),d.setExpression("top",e),d.setExpression("left",f)}}})},focus:function(b){var c=this,b=b&&-1!==a.inArray(b,["first","last"])?b:"first",d=a(":input:enabled:visible:"+b,c.d.wrap);setTimeout(function(){0<d.length?d.focus():c.d.wrap.focus()},10)},getDimensions:function(){var a="undefined"==typeof window.innerHeight?e.height():window.innerHeight;b=[c.height(),c.width()],f=[a,e.width()]},getVal:function(a,b){return a?"number"==typeof a?a:"auto"===a?0:0<a.indexOf("%")?parseInt(a.replace(/%/,""))/100*("h"===b?f[0]:f[1]):parseInt(a.replace(/px/,"")):null},update:function(a,b){if(!this.d.data)return!1;this.d.origHeight=this.getVal(a,"h"),this.d.origWidth=this.getVal(b,"w"),this.d.data.hide(),a&&this.d.container.css("height",a),b&&this.d.container.css("width",b),this.setContainerDimensions(),this.d.data.show(),this.o.focus&&this.focus(),this.unbindEvents(),this.bindEvents()},setContainerDimensions:function(){var a=j||k,b=this.d.origHeight?this.d.origHeight:i?this.d.container.height():this.getVal(a?this.d.container[0].currentStyle.height:this.d.container.css("height"),"h"),a=this.d.origWidth?this.d.origWidth:i?this.d.container.width():this.getVal(a?this.d.container[0].currentStyle.width:this.d.container.css("width"),"w"),c=this.d.data.outerHeight(!0),d=this.d.data.outerWidth(!0);this.d.origHeight=this.d.origHeight||b,this.d.origWidth=this.d.origWidth||a;var e=this.o.maxHeight?this.getVal(this.o.maxHeight,"h"):null,g=this.o.maxWidth?this.getVal(this.o.maxWidth,"w"):null,e=e&&e<f[0]?e:f[0],g=g&&g<f[1]?g:f[1],h=this.o.minHeight?this.getVal(this.o.minHeight,"h"):"auto",b=b?this.o.autoResize&&b>e?e:b<h?h:b:c?c>e?e:this.o.minHeight&&"auto"!==h&&c<h?h:c:h,e=this.o.minWidth?this.getVal(this.o.minWidth,"w"):"auto",a=a?this.o.autoResize&&a>g?g:a<e?e:a:d?d>g?g:this.o.minWidth&&"auto"!==e&&d<e?e:d:e;this.d.container.css({height:b,width:a}),this.d.wrap.css({overflow:c>b||d>a?"auto":"visible"}),this.o.autoPosition&&this.setPosition()},setPosition:function(){var a,b;a=f[0]/2-this.d.container.outerHeight(!0)/2,b=f[1]/2-this.d.container.outerWidth(!0)/2;var c="fixed"!==this.d.container.css("position")?e.scrollTop():0;this.o.position&&"[object Array]"===Object.prototype.toString.call(this.o.position)?(a=c+(this.o.position[0]||a),b=this.o.position[1]||b):a=c+a,this.d.container.css({left:b,top:a})},watchTab:function(b){if(0<a(b.target).parents(".simplemodal-container").length){if(this.inputs=a(":input:enabled:visible:first, :input:enabled:visible:last",this.d.data[0]),!b.shiftKey&&b.target===this.inputs[this.inputs.length-1]||b.shiftKey&&b.target===this.inputs[0]||0===this.inputs.length)b.preventDefault(),this.focus(b.shiftKey?"last":"first")}else b.preventDefault(),this.focus()},open:function(){this.d.iframe&&this.d.iframe.show(),a.isFunction(this.o.onOpen)?this.o.onOpen.apply(this,[this.d]):(this.d.overlay.show(),this.d.container.show(),this.d.data.show()),this.o.focus&&this.focus(),this.bindEvents()},close:function(){if(!this.d.data)return!1;this.unbindEvents();if(a.isFunction(this.o.onClose)&&!this.occb)this.occb=!0,this.o.onClose.apply(this,[this.d]);else{if(this.d.placeholder){var b=a("#simplemodal-placeholder");this.o.persist?b.replaceWith(this.d.data.removeClass("simplemodal-data").css("display",this.display)):(this.d.data.hide().remove(),b.replaceWith(this.d.orig))}else this.d.data.hide().remove();this.d.container.hide().remove(),this.d.overlay.hide(),this.d.iframe&&this.d.iframe.hide().remove(),this.d.overlay.remove(),this.d={}}}}});